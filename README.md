# CPU Test Browser Extension

一个功能强大的浏览器扩展，专门用于在 Intel HSDES 系统中提供便捷的 VNC 连接管理功能。

## 🚀 项目简介

这是一个基于现代 Web 技术栈开发的浏览器扩展，采用 Vue 3 + TypeScript 构建，提供智能的页面检测、可拖拽的悬浮窗口和高效的 VNC 连接管理。插件设计注重用户体验，支持跨浏览器运行，为 Intel HSDES 系统用户提供无缝的远程连接体验。

## ✨ 核心功能

### 🔍 智能页面检测与识别
- **自动检测**：智能识别 Intel HSDES 系统页面
- **TC 模式识别**：自动检测测试用例（Test Case）模式
- **实时监听**：监控页面单选框变化，动态响应
- **条件判断**：智能结束条件检测，优化性能

### 🖱️ 智能悬浮窗口
- **拖拽操作**：完全可拖拽的悬浮按钮设计
- **边缘吸附**：智能边缘吸附，避免遮挡重要内容
- **自动显隐**：基于鼠标焦点的自动显示/隐藏机制
- **状态指示**：多种状态显示（正常/警告/错误）
- **响应式设计**：适配不同屏幕尺寸和分辨率

### 🔗 高效的 VNC 连接管理
- **RealVNC 集成**：无缝集成 RealVNC 客户端
- **配置文件生成**：自动生成优化的 SVN 配置文件
- **原生通信**：通过原生主机实现与 VNC 客户端通信
- **重试机制**：智能的连接失败重试和错误处理
- **连接状态**：实时监控和显示连接状态

### 📊 智能内容处理
- **变化监听**：实时监听页面元素变化
- **间隔抓取**：优化的 200ms 内容抓取间隔
- **数据处理**：智能的内容解析和格式化
- **性能优化**：避免不必要的资源消耗

## 🌐 浏览器兼容性

| 浏览器 | 支持状态 | 备注 |
|--------|----------|------|
| Chrome | ✅ 完全支持 | 推荐使用 |
| Firefox | ✅ 完全支持 | 经过完整测试 |
| Edge | ✅ 完全支持 | 基于 Chromium |
| 其他 Chromium 浏览器 | ✅ 支持 | 可能需要调整配置 |

## 🛠️ 技术架构

### 前端技术栈
- **框架**：Vue 3 + Composition API
- **语言**：TypeScript（类型安全）
- **构建工具**：Vite（快速构建）
- **样式预处理器**：Less CSS
- **包管理器**：pnpm（高效依赖管理）

### 扩展技术
- **扩展 API**：WebExtensions API（跨浏览器兼容）
- **后台服务**：Service Worker（持久化运行）
- **内容脚本**：DOM 操作和页面交互
- **原生消息**：与系统原生应用通信

### 开发工具
- **代码检查**：ESLint + Prettier
- **类型检查**：TypeScript 严格模式
- **热重载**：开发时实时预览
- **多环境构建**：支持不同浏览器配置

## 📁 项目结构详解

### 源代码结构 (`src/`)
```
src/
├── components/          # Vue 组件模块
│   ├── main.vue        # 主应用组件
│   └── hostList.vue    # 主机列表组件
├── api/                # API 接口模块
│   ├── auth.ts         # 认证 API
│   └── host.ts         # 主机管理 API
├── entity/             # 数据实体定义
│   └── main.ts         # 核心类型定义
├── pages/              # 页面模块
│   └── Popup.vue       # 弹出窗口页面
├── utils/              # 工具函数模块
│   ├── http.ts         # HTTP 请求工具
│   ├── notification.ts # 通知工具
│   └── modal.ts        # 模态框工具
├── img/                # 图片资源
├── background.ts       # 后台脚本（跨域请求处理）
├── content.ts          # 内容脚本（页面注入）
├── manifest.json       # 扩展配置文件
├── popup.html          # 弹出窗口 HTML
└── popup.ts           # 弹出窗口逻辑
```

### 安装器结构 (`installer-python/`)
```
installer-python/
├── main.py            # 安装器主程序
├── build.py           # 打包脚本
├── installer.spec     # PyInstaller 配置
├── requirements.txt   # Python 依赖
├── icon/              # 程序图标
├── setp/              # 安装步骤图片
└── output/            # 打包输出目录
```

### 原生主机 (`native-host/`)
```
native-host/
└── realvnc_launcher.py  # RealVNC 启动器
```

**详细文档**：
- [源代码目录说明](src/docs/README.md)
- [安装器文档](installer-python/docs/README.md)
- [API 接口文档](src/docs/api.md)

## 🚦 快速入门指南

### 环境要求
- Node.js 16+ 
- pnpm 7+
- Python 3.7+（仅安装器需要）

### 开发环境搭建

#### 1. 安装依赖
```bash
# 使用 pnpm 安装项目依赖
pnpm install
```

#### 2. 开发模式运行
```bash
# 启动开发服务器（默认 Chrome 环境）
pnpm dev

# 指定浏览器环境
pnpm dev:chrome    # Chrome 环境
pnpm dev:firefox   # Firefox 环境
```

#### 3. 构建生产版本
```bash
# 构建所有浏览器版本
pnpm build

# 构建指定浏览器版本
pnpm build:chrome    # Chrome 版本
pnpm build:firefox   # Firefox 版本
```

### 安装器使用

#### 1. 准备 Python 环境
```bash
# 安装 Python 依赖
cd installer-python
pip install -r requirements.txt
```

#### 2. 运行安装器
```bash
# 开发模式运行
python main.py

# 打包为可执行文件
python build.py
```

## 🔧 详细配置说明

### 环境配置文件
项目支持多环境配置，便于不同浏览器的适配：

- `.env.chrome` - Chrome 环境配置
- `.env.firefox` - Firefox 环境配置  
- `.env.edge` - Edge 环境配置

### 扩展配置 (`manifest.json`)
- **权限声明**：定义扩展需要的浏览器权限
- **内容脚本**：配置注入到页面的脚本
- **后台服务**：定义持久化运行的服务
- **界面配置**：设置弹出窗口和图标

### 原生主机配置
RealVNC 原生主机需要注册到系统：
- 配置原生消息传递
- 设置 VNC 客户端路径
- 配置连接参数和安全设置

## 📋 典型使用场景

### 场景 1：HSDES 系统集成
1. 用户访问 Intel HSDES 系统
2. 扩展自动检测并激活
3. 显示悬浮连接按钮
4. 提供快速的 VNC 连接入口

### 场景 2：测试用例管理
1. 进入 TC（Test Case）模式
2. 扩展自动识别测试环境
3. 提供相关的 VNC 主机列表
4. 支持一键连接测试设备

### 场景 3：多主机管理
1. 管理多个 VNC 主机配置
2. 分组和搜索主机列表
3. 批量操作和快速切换
4. 连接状态实时监控

### 场景 4：故障恢复
1. 自动检测连接中断
2. 提供重连机制
3. 错误日志和诊断信息
4. 用户友好的错误提示

## 🔒 安全与隐私保护

### 数据安全
- **加密传输**：所有敏感数据使用加密传输
- **本地存储**：用户配置存储在本地，不上传
- **权限最小化**：只请求必要的浏览器权限
- **安全审计**：定期进行安全代码审查

### 隐私保护
- **无数据收集**：不收集用户个人隐私信息
- **透明操作**：所有操作对用户可见和可控
- **用户授权**：重要操作需要用户明确授权
- **数据清理**：提供完整的数据清理功能

### 安全特性
- **跨域安全**：通过后台服务代理跨域请求
- **输入验证**：所有用户输入进行严格验证
- **错误处理**：安全的错误信息暴露控制
- **更新机制**：支持安全更新的自动检测
- 原生主机安全通信

---

**注意**: 本项目专为Intel HSDES系统设计，在其他环境中可能无法正常工作。
# Chrome浏览器扩展安装程序

基于Python + Tkinter的图形化安装向导，使用PyInstaller打包为独立的exe文件。

## 功能特性

- ✅ **管理员权限验证** - 自动检测并提示以管理员身份运行
- ✅ **智能安装/更新** - 检测已安装版本，支持更新流程
- ✅ **注册表配置** - 自动配置Chrome原生消息传递
- ✅ **图文引导界面** - 5步骤详细安装引导
- ✅ **现代化UI** - 基于Tkinter的图形界面
- ✅ **一键打包** - 使用PyInstaller打包为独立exe

## 安装步骤引导

安装程序包含以下引导步骤：

1. **开启开发者模式** - 指导用户开启Chrome开发者模式
2. **加载扩展** - 指导用户选择安装目录加载扩展
3. **复制扩展ID** - 指导用户复制扩展ID用于配置
4. **输入扩展ID** - 用户输入复制的扩展ID
5. **刷新扩展** - 指导用户刷新扩展完成安装

## 项目结构

```
installer-python/
├── main.py              # 主安装程序
├── build.py             # 打包脚本
├── requirements.txt     # Python依赖
├── README.md           # 说明文档
├── icon.ico            # 程序图标（可选）
├── output/             # 输出目录（构建后生成）
│   └── ec-chrome-extension-installer.exe
├── build/              # 构建临时文件（构建时生成）
└── temp/               # 临时资源文件（构建时生成）
```

## 构建说明

### 环境要求

- Python 3.6+
- PyInstaller 5.0+

### 构建步骤

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **构建安装程序**
   ```bash
   python build.py
   ```

3. **运行安装程序**
   - 右键点击 `install.bat` → 以管理员身份运行
   - 或直接运行 `output/ec-chrome-extension-installer.exe`

### 构建选项

可以在 `build.py` 中修改以下配置：

- `name`: 输出文件名
- `onefile`: 是否打包为单个exe文件
- `console`: 是否显示控制台窗口
- `icon`: 程序图标文件路径
- `add_data`: 包含的额外资源文件

## 安装流程

### 全新安装
1. 验证管理员权限
2. 解压文件到 `C:\ec-chrome-extension`
3. 配置注册表
4. 显示5步骤图文引导
5. 完成安装

### 更新安装
1. 验证管理员权限
2. 检测已安装版本
3. 更新非native-host文件（避免覆盖扩展ID）
4. 显示刷新引导
5. 完成更新

## 技术实现

### 管理员权限检测
使用Windows注册表写入测试来验证管理员权限。

### 文件管理
- 使用 `shutil` 模块进行文件复制
- 更新模式时跳过 `native-host` 目录
- 自动创建必要的目录结构

### 注册表操作
- 配置Chrome原生消息传递主机
- 记录安装信息到注册表
- 使用 `winreg` 模块进行安全的注册表操作

### GUI界面
- 基于Tkinter的现代化界面
- 多步骤向导式设计
- 实时进度显示
- 响应式按钮控制

## 注意事项

1. **管理员权限** - 安装程序必须使用管理员权限运行
2. **Chrome浏览器** - 需要安装Chrome浏览器
3. **文件路径** - 安装路径固定为 `C:\ec-chrome-extension`
4. **扩展ID** - 更新安装不会覆盖现有的扩展ID
5. **兼容性** - 支持Windows 7/8/10/11

## 故障排除

### 构建问题
- 确保Python版本 >= 3.6
- 确保已安装PyInstaller
- 检查dist目录是否存在

### 运行问题
- 以管理员身份运行
- 确保Chrome浏览器已安装
- 检查杀毒软件是否阻止了安装

### 安装问题
- 如果扩展无法加载，检查开发者模式是否开启
- 如果原生消息传递失败，检查扩展ID是否正确
- 重启Chrome浏览器可能解决某些问题

## 更新日志

### v1.0.0
- 初始版本发布
- 实现基本安装功能
- 添加图文引导界面
- 支持安装/更新模式

## 许可证

本项目基于MIT许可证开源。